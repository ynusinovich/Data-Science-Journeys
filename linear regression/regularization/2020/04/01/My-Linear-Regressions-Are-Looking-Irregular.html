<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>My Linear Regressions Are Looking Irregular | Data Science Journeys</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="My Linear Regressions Are Looking Irregular" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An introductory guide to regularizing linear regressions." />
<meta property="og:description" content="An introductory guide to regularizing linear regressions." />
<link rel="canonical" href="https://ynusinovich.github.io/Data-Science-Journeys/linear%20regression/regularization/2020/04/01/My-Linear-Regressions-Are-Looking-Irregular.html" />
<meta property="og:url" content="https://ynusinovich.github.io/Data-Science-Journeys/linear%20regression/regularization/2020/04/01/My-Linear-Regressions-Are-Looking-Irregular.html" />
<meta property="og:site_name" content="Data Science Journeys" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-01T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://ynusinovich.github.io/Data-Science-Journeys/linear%20regression/regularization/2020/04/01/My-Linear-Regressions-Are-Looking-Irregular.html","@type":"BlogPosting","headline":"My Linear Regressions Are Looking Irregular","dateModified":"2020-04-01T00:00:00-05:00","datePublished":"2020-04-01T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ynusinovich.github.io/Data-Science-Journeys/linear%20regression/regularization/2020/04/01/My-Linear-Regressions-Are-Looking-Irregular.html"},"description":"An introductory guide to regularizing linear regressions.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/Data-Science-Journeys/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://ynusinovich.github.io/Data-Science-Journeys/feed.xml" title="Data Science Journeys" /><link rel="shortcut icon" type="image/x-icon" href="/Data-Science-Journeys/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/Data-Science-Journeys/">Data Science Journeys</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/Data-Science-Journeys/about/">About Me</a><a class="page-link" href="/Data-Science-Journeys/search/">Search</a><a class="page-link" href="/Data-Science-Journeys/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">My Linear Regressions Are Looking Irregular</h1><p class="page-description">An introductory guide to regularizing linear regressions.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-04-01T00:00:00-05:00" itemprop="datePublished">
        Apr 1, 2020
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/Data-Science-Journeys/categories/#linear regression">linear regression</a>
        &nbsp;
      
        <a class="category-tags-link" href="/Data-Science-Journeys/categories/#regularization">regularization</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/ynusinovich/Data-Science-Journeys/tree/master/_notebooks/2020-04-01-My-Linear-Regressions-Are-Looking-Irregular.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/Data-Science-Journeys/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/ynusinovich/Data-Science-Journeys/master?filepath=_notebooks%2F2020-04-01-My-Linear-Regressions-Are-Looking-Irregular.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/Data-Science-Journeys/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/ynusinovich/Data-Science-Journeys/blob/master/_notebooks/2020-04-01-My-Linear-Regressions-Are-Looking-Irregular.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/Data-Science-Journeys/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Theory">Theory </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Why-do-we-need-to-regularize-our-linear-regressions?-Overfitting.">Why do we need to regularize our linear regressions? Overfitting. </a></li>
<li class="toc-entry toc-h3"><a href="#The-two-most-common-types-of-regularization-for-linear-regressions-are-Lasso-and-Ridge.-Elastic-Net-is-a-mixture-of-the-two.">The two most common types of regularization for linear regressions are Lasso and Ridge. Elastic Net is a mixture of the two. </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Examples">Examples </a>
<ul>
<li class="toc-entry toc-h3"><a href="#What-kind-of-situations-would-call-for-a-regularized-linear-regression?">What kind of situations would call for a regularized linear regression? </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Code">Code </a>
<ul>
<li class="toc-entry toc-h3"><a href="#How-to-run-the-Ridge,-Lasso,-and-Elastic-Net-regressions-in-Python,-using-example-values.">How to run the Ridge, Lasso, and Elastic Net regressions in Python, using example values. </a></li>
<li class="toc-entry toc-h3"><a href="#Preparation-for-Running-the-Regressions">Preparation for Running the Regressions </a></li>
<li class="toc-entry toc-h3"><a href="#Running-a-Ridge-Regression">Running a Ridge Regression </a></li>
<li class="toc-entry toc-h3"><a href="#Running-a-Lasso-Regression">Running a Lasso Regression </a></li>
<li class="toc-entry toc-h3"><a href="#Running-an-Elastic-Net-Regression">Running an Elastic Net Regression </a></li>
<li class="toc-entry toc-h3"><a href="#Conclusions-from-the-Code">Conclusions from the Code </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-04-01-My-Linear-Regressions-Are-Looking-Irregular.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Adapted from <a href="https://generalassemb.ly/education/data-science-immersive/">General Assembly's <em>Data Science Immersive</em></a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Theory">
<a class="anchor" href="#Theory" aria-hidden="true"><span class="octicon octicon-link"></span></a>Theory<a class="anchor-link" href="#Theory"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Why-do-we-need-to-regularize-our-linear-regressions?-Overfitting.">
<a class="anchor" href="#Why-do-we-need-to-regularize-our-linear-regressions?-Overfitting." aria-hidden="true"><span class="octicon octicon-link"></span></a>Why do we need to regularize our linear regressions? Overfitting.<a class="anchor-link" href="#Why-do-we-need-to-regularize-our-linear-regressions?-Overfitting."> </a>
</h3>
<p>What is overfitting?</p>
<ul>
<li>Overfitting means building a model that matches the training data "too closely."</li>
<li>The model ends up fitting to noise rather than signal.</li>
<li>The <strong>bias is too low</strong> and the <strong>variance is too high</strong>.</li>
</ul>
<p>What can cause overfitting?</p>
<ul>
<li>Irrelevant features are included in the model.</li>
<li>The number of features is close to the number of observations.</li>
<li>The features are correlated to each other.</li>
<li>The coefficients of the features are large.
What is regularization and how does it help?</li>
<li>Regularization helps against overfitting by imposing a penalty that decreases the coefficients of the features.</li>
<li>Regularization lowers the fit for the training data, but it improves the fit for the test data.</li>
</ul>
<h3 id="The-two-most-common-types-of-regularization-for-linear-regressions-are-Lasso-and-Ridge.-Elastic-Net-is-a-mixture-of-the-two.">
<a class="anchor" href="#The-two-most-common-types-of-regularization-for-linear-regressions-are-Lasso-and-Ridge.-Elastic-Net-is-a-mixture-of-the-two." aria-hidden="true"><span class="octicon octicon-link"></span></a>The two most common types of regularization for linear regressions are <em>Lasso</em> and <em>Ridge</em>. <em>Elastic Net</em> is a mixture of the two.<a class="anchor-link" href="#The-two-most-common-types-of-regularization-for-linear-regressions-are-Lasso-and-Ridge.-Elastic-Net-is-a-mixture-of-the-two."> </a>
</h3>
<ul>
<li>Lasso uses the L1 regularization method, Ridge uses L2, and Elastic Net uses both.</li>
<li>We will be regularizing linear regressions in this post, but other types of regressions can be regularized with L1 and L2 as well.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Examples">
<a class="anchor" href="#Examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples<a class="anchor-link" href="#Examples"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What-kind-of-situations-would-call-for-a-regularized-linear-regression?">
<a class="anchor" href="#What-kind-of-situations-would-call-for-a-regularized-linear-regression?" aria-hidden="true"><span class="octicon octicon-link"></span></a>What kind of situations would call for a regularized linear regression?<a class="anchor-link" href="#What-kind-of-situations-would-call-for-a-regularized-linear-regression?"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Predicting home prices  based on number of bedrooms upstairs, number of bedrooms downstairs, and total number of bedrooms.</li>
<li>Predicting a wine's rating based on its fixed acidity, volatile acidity, citric acid, residual sugar, chloride, free sulfur dioxide, total sulfur dioxide, density, pH, sulphates, and percent alcohol.</li>
<li>Predicting the ratio of scores for the teams in a basketball game based on the player stats and the team stats.</li>
<li>Estimating a country's life expectancy based on gross domestic product per person, infant mortality, and region of the world.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Code">
<a class="anchor" href="#Code" aria-hidden="true"><span class="octicon octicon-link"></span></a>Code<a class="anchor-link" href="#Code"> </a>
</h2>
<h3 id="How-to-run-the-Ridge,-Lasso,-and-Elastic-Net-regressions-in-Python,-using-example-values.">
<a class="anchor" href="#How-to-run-the-Ridge,-Lasso,-and-Elastic-Net-regressions-in-Python,-using-example-values." aria-hidden="true"><span class="octicon octicon-link"></span></a>How to run the Ridge, Lasso, and Elastic Net regressions in Python, using example values.<a class="anchor-link" href="#How-to-run-the-Ridge,-Lasso,-and-Elastic-Net-regressions-in-Python,-using-example-values."> </a>
</h3>
<h3 id="Preparation-for-Running-the-Regressions">
<a class="anchor" href="#Preparation-for-Running-the-Regressions" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>Preparation for Running the Regressions</em><a class="anchor-link" href="#Preparation-for-Running-the-Regressions"> </a>
</h3>
<ul>
<li>Start by importing the Pandas and NumPy libraries, in order to create DataFrames and arrays, as well as the different types of linear regressions we will use, Ridge, Lasso, and Elastic Net:</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">RidgeCV</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">LassoCV</span><span class="p">,</span> <span class="n">ElasticNet</span><span class="p">,</span> <span class="n">ElasticNetCV</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Store your training dataset's features in a Pandas DataFrame as X</li>
<li>Store your training dataset's target variable in an array as y.</li>
<li>This is the R<sup>2</sup> score from <strong>cross-validation</strong> for a linear regression for the sample dataset:</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">cross_val_score</span><span class="p">(</span><span class="n">lr_model</span><span class="p">,</span> <span class="n">X_overfit</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>0.1913277098938003</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>The R<sup>2</sup> score is very low. Is the model overfitted, and will regularization improve it?</li>
</ul>
<h3 id="Running-a-Ridge-Regression">
<a class="anchor" href="#Running-a-Ridge-Regression" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>Running a Ridge Regression</em><a class="anchor-link" href="#Running-a-Ridge-Regression"> </a>
</h3>
<ul>
<li>Ridge regression is <strong>more computationally efficient than Lasso</strong>.</li>
<li>Ridge regression usually uses larger $\alpha$ (values for the penalty) than the Lasso regression.</li>
</ul>
<p>Pick a list of $\alpha$-values, instantiate the model, and fit the regression. Save the optimal model and check its R<sup>2</sup> score from cross-validation:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">ridge_model</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span> <span class="o">=</span> <span class="n">alpha_list</span><span class="p">,</span> <span class="n">store_cv_values</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="c1"># store_cv_values picks best alpha value</span>
<span class="n">ridge_model</span> <span class="o">=</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_overfit</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ridge_model</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>821.434358491943</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ridge_opt_model</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">)</span>
<span class="n">cross_val_score</span><span class="p">(</span><span class="n">ridge_opt_model</span><span class="p">,</span> <span class="n">X_overfit</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>0.2221069221200395</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This R<sup>2</sup> score is an improvement over the linear regression.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Running-a-Lasso-Regression">
<a class="anchor" href="#Running-a-Lasso-Regression" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>Running a Lasso Regression</em><a class="anchor-link" href="#Running-a-Lasso-Regression"> </a>
</h3>
<ul>
<li>If group of predictors are highly correlated, the Lasso regression picks only one of them and shrinks the others to zero.</li>
<li>The Lasso regression is better with smaller $\alpha$ (values for the penalty) than the Ridge regression.</li>
</ul>
<p>Pick a list of $\alpha$-values, instantiate the model, and fit the regression. Save the optimal model and check its R<sup>2</sup> score from cross-validation:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l_alpha_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.0025</span><span class="p">)</span>
<span class="n">lasso_model</span> <span class="o">=</span> <span class="n">LassoCV</span><span class="p">(</span><span class="n">alphas</span> <span class="o">=</span> <span class="n">l_alpha_list</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">lasso_model</span> <span class="o">=</span> <span class="n">lasso_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_overfit</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">lasso_model</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>0.011</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lasso_model</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">lasso_model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">)</span>
<span class="n">cross_val_score</span><span class="p">(</span><span class="n">lasso_model</span><span class="p">,</span> <span class="n">X_overfit</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>0.2617417795359766</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This R<sup>2</sup> score is an improvement over the Ridge regression.</p>
<h3 id="Running-an-Elastic-Net-Regression">
<a class="anchor" href="#Running-an-Elastic-Net-Regression" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>Running an Elastic Net Regression</em><a class="anchor-link" href="#Running-an-Elastic-Net-Regression"> </a>
</h3>
<ul>
<li>The Elastic Net regression adds a larger penalty than the Ridge and Lasso regressions.</li>
<li>Elastic Net should only be used if the training accuracy is much higher than the test accuracy or if the independent variables are highly correlated.</li>
</ul>
<p>Pick a list of $\alpha$-values, instantiate the model, and fit the regression. Save the optimal model and check its R<sup>2</sup> score from cross-validation:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">enet_alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>
<span class="n">enet_model</span> <span class="o">=</span> <span class="n">ElasticNetCV</span><span class="p">(</span><span class="n">alphas</span> <span class="o">=</span> <span class="n">enet_alphas</span><span class="p">)</span>
<span class="n">enet_model</span> <span class="o">=</span> <span class="n">enet_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_overfit</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">enet_model</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>0.5</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">enet_model</span> <span class="o">=</span> <span class="n">ElasticNet</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">enet_model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">)</span>
<span class="n">cross_val_score</span><span class="p">(</span><span class="n">enet_model</span><span class="p">,</span> <span class="n">X_overfit</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>0.07522288223865307</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This R<sup>2</sup> score is worse than the linear regression, the Ridge regression, and the Lasso regression, so this model penalized our feature coefficients too much.</p>
<h3 id="Conclusions-from-the-Code">
<a class="anchor" href="#Conclusions-from-the-Code" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>Conclusions from the Code</em><a class="anchor-link" href="#Conclusions-from-the-Code"> </a>
</h3>
<ul>
<li>For this dataset, the best model was Lasso regression. Compare all of the models with ranges of parameters to determine the best-fitting model.</li>
<li>Don't forget to perform feature engineering before modeling, and to re-optimize your model if you go back and engineer features. Feature engineering will affect the optimal model and its optimal parameters.</li>
</ul>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="ynusinovich/Data-Science-Journeys"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/Data-Science-Journeys/linear%20regression/regularization/2020/04/01/My-Linear-Regressions-Are-Looking-Irregular.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/Data-Science-Journeys/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/Data-Science-Journeys/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/Data-Science-Journeys/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Yan Nusinovich&#39;s Data Science Blog</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/ynusinovich" target="_blank" title="ynusinovich"><svg class="svg-icon grey"><use xlink:href="/Data-Science-Journeys/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/ynusinovich" target="_blank" title="ynusinovich"><svg class="svg-icon grey"><use xlink:href="/Data-Science-Journeys/assets/minima-social-icons.svg#linkedin"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
